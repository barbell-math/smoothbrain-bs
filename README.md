<!-- gomarkdoc:embed:start -->

<!-- Code generated by gomarkdoc. DO NOT EDIT -->

# sbbs

```go
import "github.com/barbell-math/smoothbrain-bs"
```

A very simple build system written in 100% golang to avoid the need to have cmake as a dependency.

## Index

- [Variables](<#variables>)
- [func Cd\(dir string\) error](<#Cd>)
- [func CreateFile\(name string\) \(\*os.File, error\)](<#CreateFile>)
- [func GitRevParse\(ctxt context.Context, cwd string\) \(string, error\)](<#GitRevParse>)
- [func LogErr\(fmt string, args ...any\)](<#LogErr>)
- [func LogInfo\(fmt string, args ...any\)](<#LogInfo>)
- [func LogPanic\(fmt string, args ...any\)](<#LogPanic>)
- [func LogQuietInfo\(fmt string, args ...any\)](<#LogQuietInfo>)
- [func LogSuccess\(fmt string, args ...any\)](<#LogSuccess>)
- [func LogWarn\(fmt string, args ...any\)](<#LogWarn>)
- [func Main\(progName string\)](<#Main>)
- [func Mkdir\(path string\) error](<#Mkdir>)
- [func Open\(name string\) \(\*os.File, error\)](<#Open>)
- [func RegisterTarget\(ctxt context.Context, name string, stages ...StageFunc\)](<#RegisterTarget>)
- [func Run\(ctxt context.Context, pipe io.Writer, prog string, args ...string\) error](<#Run>)
- [func RunCwd\(ctxt context.Context, pipe io.Writer, cwd string, prog string, args ...string\) error](<#RunCwd>)
- [func RunCwdStdout\(ctxt context.Context, cwd string, prog string, args ...string\) error](<#RunCwdStdout>)
- [func RunStdout\(ctxt context.Context, prog string, args ...string\) error](<#RunStdout>)
- [func RunTarget\(ctxt context.Context, target string, cmdLineArgs ...string\)](<#RunTarget>)
- [func Touch\(name string\) error](<#Touch>)
- [type StageFunc](<#StageFunc>)
  - [func CdToRepoRoot\(\) StageFunc](<#CdToRepoRoot>)
  - [func Stage\(name string, op func\(ctxt context.Context, cmdLineArgs ...string\) error\) StageFunc](<#Stage>)
  - [func TargetAsStage\(target string\) StageFunc](<#TargetAsStage>)
- [type TargetFunc](<#TargetFunc>)


## Variables

<a name="StopErr"></a>

```go
var (

    // An error that a stage can return to stop the target it is part of from
    // further execution. This is intended to be used when other error
    // information has been printed to the console.
    StopErr = errors.New("Generic stop error. See log above for error details.")
)
```

<a name="Cd"></a>
## func [Cd](<https://github.com/barbell-math/smoothbrain-bs/blob/main/bs.go#L140>)

```go
func Cd(dir string) error
```

A helpful utility function that changes the programs current working directory and logs the old and new current working directories.

<a name="CreateFile"></a>
## func [CreateFile](<https://github.com/barbell-math/smoothbrain-bs/blob/main/bs.go#L111>)

```go
func CreateFile(name string) (*os.File, error)
```

A helpful utility function that creates a file and logs the file's path.

<a name="GitRevParse"></a>
## func [GitRevParse](<https://github.com/barbell-math/smoothbrain-bs/blob/main/bs.go#L158>)

```go
func GitRevParse(ctxt context.Context, cwd string) (string, error)
```

A helpful utility function that runs \`git rev\-parse \-\-show\-toplevel\` and returns the stdout. This is often useful when attempting to change the current working directory to a repositories root directory.

<a name="LogErr"></a>
## func [LogErr](<https://github.com/barbell-math/smoothbrain-bs/blob/main/bs.go#L100>)

```go
func LogErr(fmt string, args ...any)
```

Logs errors in red.

<a name="LogInfo"></a>
## func [LogInfo](<https://github.com/barbell-math/smoothbrain-bs/blob/main/bs.go#L80>)

```go
func LogInfo(fmt string, args ...any)
```

Logs info in cyan.

<a name="LogPanic"></a>
## func [LogPanic](<https://github.com/barbell-math/smoothbrain-bs/blob/main/bs.go#L105>)

```go
func LogPanic(fmt string, args ...any)
```

Logs errors in bold red and exits.

<a name="LogQuietInfo"></a>
## func [LogQuietInfo](<https://github.com/barbell-math/smoothbrain-bs/blob/main/bs.go#L85>)

```go
func LogQuietInfo(fmt string, args ...any)
```

Logs quiet info in gray.

<a name="LogSuccess"></a>
## func [LogSuccess](<https://github.com/barbell-math/smoothbrain-bs/blob/main/bs.go#L90>)

```go
func LogSuccess(fmt string, args ...any)
```

Logs successes in green.

<a name="LogWarn"></a>
## func [LogWarn](<https://github.com/barbell-math/smoothbrain-bs/blob/main/bs.go#L95>)

```go
func LogWarn(fmt string, args ...any)
```

Logs warnings in yellow.

<a name="Main"></a>
## func [Main](<https://github.com/barbell-math/smoothbrain-bs/blob/main/bs.go#L329>)

```go
func Main(progName string)
```

The main function that runs the build system. This is intended to be called by the \`main\` function of any code that uses this library.

<a name="Mkdir"></a>
## func [Mkdir](<https://github.com/barbell-math/smoothbrain-bs/blob/main/bs.go#L133>)

```go
func Mkdir(path string) error
```

A helpful utility function that creates the supplied directory as well as all necessary parent directories.

<a name="Open"></a>
## func [Open](<https://github.com/barbell-math/smoothbrain-bs/blob/main/bs.go#L117>)

```go
func Open(name string) (*os.File, error)
```

A helpful utility function that opens a file and logs the file's path.

<a name="RegisterTarget"></a>
## func [RegisterTarget](<https://github.com/barbell-math/smoothbrain-bs/blob/main/bs.go#L307>)

```go
func RegisterTarget(ctxt context.Context, name string, stages ...StageFunc)
```

Registers a new build target to the build system. When run, the new target will sequentially run all provided stages, stopping if an error is encountered.

<a name="Run"></a>
## func [Run](<https://github.com/barbell-math/smoothbrain-bs/blob/main/bs.go#L200-L205>)

```go
func Run(ctxt context.Context, pipe io.Writer, prog string, args ...string) error
```

Runs the program with the specified \`args\` using the supplied context in the current working directory. The supplied pipe will be used to capture Stdout. Stderr will always be printed to the console.

<a name="RunCwd"></a>
## func [RunCwd](<https://github.com/barbell-math/smoothbrain-bs/blob/main/bs.go#L167-L173>)

```go
func RunCwd(ctxt context.Context, pipe io.Writer, cwd string, prog string, args ...string) error
```

Runs the program with the specified \`args\` using the supplied context. The supplied pipe will be used to capture Stdout. Stderr will always be printed to the console.

<a name="RunCwdStdout"></a>
## func [RunCwdStdout](<https://github.com/barbell-math/smoothbrain-bs/blob/main/bs.go#L212-L217>)

```go
func RunCwdStdout(ctxt context.Context, cwd string, prog string, args ...string) error
```

Runs the program with the specified \`args\` using the supplied context. All output of the program will be printed to stdout. Equivalent to calling [Run](<#Run>) and providing [os.Stdout](<https://pkg.go.dev/os/#Stdout>) for the \`pipe\` argument.

<a name="RunStdout"></a>
## func [RunStdout](<https://github.com/barbell-math/smoothbrain-bs/blob/main/bs.go#L225>)

```go
func RunStdout(ctxt context.Context, prog string, args ...string) error
```

Runs the program with the specified \`args\` using the supplied context in the current working directory. All output of the program will be printed to stdout. Equivalent to calling [Run](<#Run>) and providing [os.Stdout](<https://pkg.go.dev/os/#Stdout>) for the \`pipe\` argument.

<a name="RunTarget"></a>
## func [RunTarget](<https://github.com/barbell-math/smoothbrain-bs/blob/main/bs.go#L232>)

```go
func RunTarget(ctxt context.Context, target string, cmdLineArgs ...string)
```

Runs the supplied target, given that the supplied target is present in the build systems target list. Execution of all further targets/stages will stop if running the supplied target fails.

<a name="Touch"></a>
## func [Touch](<https://github.com/barbell-math/smoothbrain-bs/blob/main/bs.go#L124>)

```go
func Touch(name string) error
```

A helpful utility function that creates but does not open a file and logs the file's path.

<a name="StageFunc"></a>
## type [StageFunc](<https://github.com/barbell-math/smoothbrain-bs/blob/main/bs.go#L30>)

The function that will be executed to perform an operation for a given target. The supplied context is meant to be used to control the runtime of the stage operation.

```go
type StageFunc func(ctxt context.Context, cmdLineArgs ...string) error
```

<a name="CdToRepoRoot"></a>
### func [CdToRepoRoot](<https://github.com/barbell-math/smoothbrain-bs/blob/main/bs.go#L276>)

```go
func CdToRepoRoot() StageFunc
```

Changes the current working directory to the repositories root directory if the current working directory is inside a repo. Results in an error if the current working directory is not inside a repo.

<a name="Stage"></a>
### func [Stage](<https://github.com/barbell-math/smoothbrain-bs/blob/main/bs.go#L244-L247>)

```go
func Stage(name string, op func(ctxt context.Context, cmdLineArgs ...string) error) StageFunc
```

Creates a stage that can be added to a build target. Stages define the operations that will take place when a build target is executing. The supplied context can be modified and passed to [Run](<#Run>) functions to deterministically control how long various operations take. This prevents builds from hanging forever.

<a name="TargetAsStage"></a>
### func [TargetAsStage](<https://github.com/barbell-math/smoothbrain-bs/blob/main/bs.go#L294>)

```go
func TargetAsStage(target string) StageFunc
```

Runs the supplied target as though it were a stage, given that the supplied target is preset in the build systems target list. Execution of all further targets/stages will stop if running the supplied target fails.

<a name="TargetFunc"></a>
## type [TargetFunc](<https://github.com/barbell-math/smoothbrain-bs/blob/main/bs.go#L25>)

The function that will be executed when a target is run. This function will be given all of the leftover cmd line arguments that were supplied after the target. Parsing of these arguments is up to the logic defined be the targets stages.

```go
type TargetFunc func(cmdLineArgs ...string)
```

Generated by [gomarkdoc](<https://github.com/princjef/gomarkdoc>)


<!-- gomarkdoc:embed:end -->

## Examples

For examples of using this build system refer to the following repositories:

1. [smoothbrain-errs](https://github.com/barbell-math/smoothbrain-errs/tree/main/bs/bs.go)
1. [smoothbrain-test](https://github.com/barbell-math/smoothbrain-test/tree/main/bs/bs.go)
1. [smoothbrain-hashmap](https://github.com/barbell-math/smoothbrain-hashmap/tree/main/bs)
1. [smoothbrain-argparse](https://github.com/barbell-math/smoothbrain-argparse/tree/main/bs/bs.go)

## Helpful Developer Cmds

To build the build system the first time:

```
go build -o ./bs/bs ./bs
```

The build system can then be used as usual:

```
./bs/bs --help
./bs/bs buildBs # builds the build system!
```
